\documentclass[10pt, a4paper]{article}
\usepackage[paper=a4paper, left=1.5cm, right=1.5cm, bottom=1.5cm, top=3.5cm]{geometry}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{latexsym}
\usepackage{lastpage}
\usepackage{aed2-symb,aed2-itef,aed2-tad}
\usepackage[colorlinks=true, linkcolor=blue]{hyperref}
\usepackage{calc}

\newcommand{\f}[1]{\text{#1}}
\renewcommand{\paratodo}[2]{$\forall~#2$: #1}

\sloppy

\hypersetup{%
 % Para que el PDF se abra a página completa.
 pdfstartview= {FitH \hypercalcbp{\paperheight-\topmargin-1in-\headheight}},
 pdfauthor={Cátedra de Algoritmos y Estructuras de Datos II - DC - UBA},
 pdfkeywords={TADs básicos},
 pdfsubject={Tipos abstractos de datos básicos}
}

\parskip=5pt % 10pt es el tamaño de fuente

% Pongo en 0 la distancia extra entre ítemes.
\let\olditemize\itemize
\def\itemize{\olditemize\itemsep=0pt}

% Acomodo fancyhdr.
\pagestyle{fancy}
\thispagestyle{fancy}
\addtolength{\headheight}{1pt}
\lhead{Algoritmos y Estructuras de Datos II}
\rhead{$1^{\mathrm{do}}$ cuatrimestre de 2006}
\cfoot{\thepage /\pageref{LastPage}}
\renewcommand{\footrulewidth}{0.4pt}

\title{Tipos abstractos de datos básicos}
\author{Algoritmos y Estructuras de Datos II, DC, UBA.}
\date{8 de Septiembre de 2012}

\begin{document}

%Pagina de titulo e indice
\thispagestyle{empty}

\maketitle
\tableofcontents

\newpage

%TADS
\section{TAD \tadNombre{Categoría}}
\noindent \textbf{TAD \textsc{Categoría} es \textsc{String}}

\section{TAD \tadNombre{Link}}
\noindent \textbf{TAD \textsc{Link} es \textsc{String}}

\section{TAD \tadNombre{Día}}
\noindent \textbf{TAD \textsc{Día} es \textsc{Nat}}

\section{TAD \tadNombre{ÁrbolDeCategorías}}
\begin{tad}{\tadNombre{ÁrbolDeCategorías}}

	\tadGeneros{árbolDeCategorías}
	
	\tadExporta{árbolDeCategorías, generadores, observadores básicos, contiene?, buscarNodo, aplanar}
	
	\tadUsa{\tadNombre{Bool, Categoría, Conjunto(ÁrbolDeCategorías), Conjunto(Categoría)}}
	
	\tadIgualdadObservacional{a}{a'}{árbolDeCategorías}{raíz($a$) \igobs raíz($a'$) $\land$ hijos($a$) \igobs hijos($a'$)}

	\tadAlinearFunciones{buscarNodoEnConjunto}{categoría/c,conj(árbolDeCategorías)/as}
	
	\tadGeneradores
	\tadOperacion{árbol}{categoría/c,conj(árbolDeCategorías)/as}{árbolDeCategorías}{}
	
	\tadObservadores
	\tadOperacion{raíz}{árbolDeCategorías}{categoría}{}
	\tadOperacion{hijos}{árbolDeCategorías}{conj(árbolDeCategorías)}{}
	
	\tadOtrasOperaciones
	\tadOperacion{contiene?}{categoría,árbolDeCategorías}{bool}{}
	\tadOperacion{buscarNodo}{categoría/c,árbolDeCategorías/a}{árbolDeCategorías}{contiene?($c$, $a$)}
	\tadOperacion{buscarNodoEnConjunto}{categoría,conj(árbolDeCategorías)}{árbolDeCategorías}{}
	\tadOperacion{aplanar}{árbolDeCategorías}{conj(categoría)}{}
	\tadOperacion{aplanarConjunto}{conj(árbolDeCategorías)}{conj(categoría)}{}	

	\tadAxiomas[\paratodo{categoría}{c}, \paratodo{árbolDeCategorías}{a}, \paratodo{conj(árbolDeCategorías)}{as}]
	\tadAlinearAxiomas{buscarNodoEnConjunto($c$, $as$)}	
	\tadAxioma{raíz(árbol($c$, $as$))}{$c$}
	\tadAxioma{hijos(árbol($c$, $as$))}{$as$}
	\tadAxioma{contiene?($c$, $a$)}{$c$ $\in$ aplanar($a$)}	
	\tadAxioma{buscarNodo($c$, $a$)}{buscarNodoEnConjunto($c$, Ag($a$, $\emptyset$))}		
	\tadAxioma{buscarNodoEnConjunto($c$, $as$)}{
		\IF $c$ = raíz(dameUno($as$)
		THEN dameUno($as$)
		ELSE buscarNodoEnConjunto($c$, hijos(dameUno($as$)) $\cup$ sinUno($as$))
		FI
	}
	\tadAxioma{aplanar($a$)}{aplanarConjunto(Ag($a$, $\emptyset$))}
	\tadAxioma{aplanarConjunto($as$)}{
		\IF $\emptyset$?($as$)
		THEN $\emptyset$
		ELSE Ag(raíz(dameUno($as$)), \\
			\hspace*{5mm}aplanarConjunto(hijos(dameUno($as$)) $\cup$ sinUno($as$)))
		FI
	}
\end{tad}

\section{TAD \tadNombre{LinkLinkIt}}
\begin{tad}{\tadNombre{LinkLinkIt}}

	\tadGeneros{linkLinkIt}
	
	\tadExporta{linkLinkIt, generadores, observadores básicos, \#LinksEnCategoría, \#AccesosMásRecientes}
	
	\tadUsa{\tadNombre{Bool, Nat, Categoría, Link, Día, ÁrbolDeCategorías, Conjunto(Categoría),\\ Conjunto(Link)}}
	
	\tadIgualdadObservacional{lli}{lli'}{linkLinkIt}{
        darÁrbolDeCategorías($lli$) \igobs \\
        \hspace*{5mm}darÁrbolDeCategorías($lli'$) $\land$ \\
		links($lli$) \igobs links($lli'$) $\yluego$ \\
		$(\forall l:\text{link})$ ($l$ $\in$ links($lli$) $\impluego$ ( \\
		\hspace*{5mm}categoríaLink($l$, $lli$) \igobs categoríaLink($l$, $lli'$) $\land$ \\
		\hspace*{5mm}$(\forall d:\text{día})$ (\#AccesosPorDía($l$, $d$, $lli$) \igobs \\
		\hspace*{10mm}\#AccesosPorDía($l$, $d$, $lli'$))))	
	}

	\tadAlinearFunciones{darÁrbolDeCategorías}{link/l,categoría/c,linkLinkIt/lli}
	
	\tadGeneradores
	\tadOperacion{iniciar}{árbolDeCategorías}{linkLinkIt}{}
	\tadOperacion{registrarLink}{link/l,categoría/c,linkLinkIt/lli}{linkLinkIt}{
		$\neg$($l$ $\in$ links($lli$)) $\land$ contiene?($c$, darÁrbolDeCategorías($lli$))
	}
	\tadOperacion{registrarAcceso}{link/l,día/d,linkLinkIt/lli}{linkLinkIt}{
		$l$ $\in$ links($lli$) $\land$ $d$ $\geq$ díaÚltimoAcceso($lli$)
	}
	
	\tadObservadores
	\tadOperacion{darÁrbolDeCategorías}{linkLinkIt}{árbolDeCategorías}{}	
	\tadOperacion{links}{linkLinkIt}{conj(link)}{}		
	\tadOperacion{categoríaLink}{link/l,linkLinkIt/lli}{categoría}{$l$ $\in$ links($lli$)}	
	\tadOperacion{\#AccesosPorDía}{link/l,día/d,linkLinkIt/lli}{nat}{$l$ $\in$ links($lli$)}

	\tadAlinearFunciones{filtrarYContarLinksPorCategoría}{conj(links)/ls,conj(categoría)/cs,linkLinkIt/lli}

	\tadOtrasOperaciones	
	\tadOperacion{díaÚltimoAcceso}{linkLinkIt}{nat}{}
	\tadOperacion{\#LinksEnCategoría}{categoría/c,linkLinkIt/lli}{nat}{contiene?($c$, darÁrbolDeCategorías($lli$)}
	\tadOperacion{filtrarYContarLinksPorCategoría}{conj(links)/ls,conj(categoría)/cs,linkLinkIt/lli}{bool}{$ls$ $\subseteq$ links($lli$)}
	\tadOperacion{\#AccesosMásRecientes}{link/l,linkLinkIt/lli}{nat}{$l$ $\in$ links($lli$)}
		
	\tadAxiomas[\paratodo{categoría}{c}, \paratodo{conj(categoría)}{cs}, \paratodo{link}{l,l'}, \paratodo{conj(link)}{ls}, \paratodo{día}{d,d'},\\ \paratodo{árbolDeCategorías}{a}, \paratodo{linkLinkIt}{lli}]
	\tadAlinearAxiomas{\#AccesosPorDía($l$, $d$, registrarAcceso($l'$, $d'$, $lli$))}
	\tadAxioma{darÁrbolDeCategorías(iniciar($a$))}{$a$}
	\tadAxioma{darÁrbolDeCategorías(registrarLink($l$, $c$, $lli$))}{darÁrbolDeCategorías($lli$)}
	\tadAxioma{darÁrbolDeCategorías(registrarAcceso($l$, $d$, $lli$))}{darÁrbolDeCategorías($lli$)}	
	\tadAxioma{links(iniciar($a$))}{$\emptyset$}
	\tadAxioma{links(registrarLink($l$, $c$, $lli$)}{Ag($l$, links($lli$))}
	\tadAxioma{links(registrarAcceso($l$, $d$, $lli$)}{links($lli$)}
	\tadAxioma{categoríaLink($l$, registrarLink($l'$, $c$, $lli$))}{
		\IF $l$ = $l'$
		THEN $c$
		ELSE categoríaLink($l$, $lli$)
		FI
	}
	\tadAxioma{categoríaLink($l$, registrarAcceso($l'$, $d$, $lli$))}{categoríaLink($l$, $lli$)}
	\tadAxioma{\#AccesosPorDía($l$, $d$, iniciar($a$))}{0}
	\tadAxioma{\#AccesosPorDía($l$, $d$, registrarLink($l'$, $c$, $lli$))}{\#AccesosPorDía($l$, $d$, $lli$)}
	\tadAxioma{\#AccesosPorDía($l$, $d$, registrarAcceso($l'$, $d'$, $lli$))}{
		(\IF $l$ = $l'$ $\land$ $d$ = $d'$
		THEN 1
		ELSE 0
		FI) +\\
		\hspace*{5mm}\#AccesosPorDía($l$, $d$, $lli$)
	}
	\tadAxioma{díaÚltimoAcceso(iniciar($a$))}{0}
	\tadAxioma{díaÚltimoAcceso(registrarLink($l$, $c$, $lli$))}{díaÚltimoAcceso($lli$)}
	\tadAxioma{díaÚltimoAcceso(registrarAcceso($l$, $d$, $lli$))}{$d$}
	\tadAxioma{\#LinksEnCategoría($c$, $lli$)}{
		filtrarYContarLinksPorCategoría(\\
			\hspace*{5mm}links($lli$),\\
			\hspace*{5mm}aplanar(buscarNodo($c$, darÁrbolDeCategorías($lli$))),\\
			\hspace*{5mm}$lli$)
	}
	\tadAxioma{filtrarYContarLinksPorCategoría($ls$, $cs$, $lli$)}{
		\IF $\emptyset$?($ls$)
		THEN 0
		ELSE
			({\IF categoríaLink(dameUno($ls$), $lli$) $\in$ $cs$
			THEN 1
			ELSE 0
			FI}) + \\
			filtrarYContarLinksPorCategoría(sinUno($ls$), $cs$, $lli$)
		FI
	}
	\tadAxioma{\#AccesosMásRecientes($l$, $lli$)}{
		\#AccesosPorDía($l$, díaÚltimoAcceso($lli$), $lli$) +\\
		(\IF díaÚltimoAcceso($lli$) $\geq$ 1
		THEN \#AccesosPorDía($l$, díaÚltimoAcceso($lli$) - 1, $lli$) 
		ELSE 0
		FI) + \\
		(\IF díaÚltimoAcceso($lli$) $\geq$ 2
		THEN \#AccesosPorDía($l$, díaÚltimoAcceso($lli$) - 2, $lli$) 
		ELSE 0
		FI)
	}
\end{tad}

\end{document}
